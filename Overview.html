<!DOCTYPE html>
<html>
  <head>
    <title>
      The Screen Orientation API
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class=
    'remove'>
</script>
    <script class='remove'>
var respecConfig = {
          specStatus:           "ED",
          shortName:            "screen-orientation",

          publishDate:          "2013-07-30",
          previousPublishDate:  "2012-12-06",
          previousMaturity:     "ED",
          edDraftURI:           "http://dvcs.w3.org/hg/screen-orientation/raw-file/tip/Overview.html",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",
          extraCSS:      ["../ReSpec.js/css/respec.css"],
          noIDLIn:       true,
          noLegacyStyle: true,

          editors:  [
              { name: "Mounir Lamouri",
                company: "Mozilla",
                companyURL: "http://mozilla.org/" },
          ],

          wg:           "Web Applications Working Group",
          wgURI:        "http://www.w3.org/2008/webapps/",
          wgPublicList: "public-webapps",
          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/42538/status",
      };
    </script>
  </head>
  <body>
    <section id='abstract'>
      The Screen Orientation API's goal is to provide an interface for web
      applications to be able to read the screen orientation state, to be
      informed when this state changes and to be able to lock the screen
      orientation to a specific state.
    </section>
    <section class='informative'>
      <h2>
        Introduction
      </h2>
      <p>
        The Screen Orientation API provides an interface for web applications
        to access and lock the user's device's screen orientation state.
      </p>
      <p>
        This examples is an application that shows the current screen
        orientation to the user every time the screen orientation state
        changes:
      </p>
      <pre class='example highlight'>
        &lt;!DOCTYPE html&gt;
        &lt;html&gt;
          &lt;script&gt;
            function show() {
              alert("Screen orientation state is " + screen.orientation);
            }

            screen.addEventListener("orientationchange", show, false);

            show();
          &lt;/script&gt;
        &lt;/html&gt;
      
</pre>
    </section>
    <section id='conformance'>
      <p>
        This specification defines conformance criteria that apply to a single
        product: the <dfn>user agent</dfn> that implements the interfaces that
        it contains.
      </p>
      <p>
        Implementations that use ECMAScript to expose the APIs defined in this
        specification must implement them in a manner consistent with the
        ECMAScript Bindings defined in the Web IDL specification [[!WEBIDL]].
      </p>
    </section>
    <section>
      <h2>
        Terminology
      </h2>
      <p>
        The <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#eventhandler">EventHandler</a></dfn>
        interface represents a callback used for event handlers as defined in
        [[!HTML5]].
      </p>
      <p>
        The concepts <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue a
        task</a></dfn> and <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">fire
        a simple event</a></dfn> are defined in [[!HTML5]].
      </p>
      <p>
        The terms <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#event-handlers">event
        handlers</a></dfn> and <dfn><a href=
        "http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">
        event handler event types</a></dfn> are defined in [[!HTML5]].
      </p>
      <p>
        The concepts of <dfn><a href=
        "http://dev.w3.org/html5/spec/browsers.html#browsing-context">browsing
        context</a></dfn> and <dfn><a href=
        "http://dev.w3.org/html5/spec/browsers.html#active-document">active
        document</a></dfn> are defined in [[!HTML5]].
      </p>
      <section>
        <h2>
          Current orientation
        </h2>
        <p>
          The <dfn>current orientation</dfn> SHOULD be an orientation amongst
          those values:
        </p>
        <ul>
          <li>
            <code>portrait-primary</code>, if the orientation is in the primary
            portrait mode;
          </li>
          <li>
            <code>portrait-secondary</code>, if the orientation is in the
            secondary portrait mode;
          </li>
          <li>
            <code>landscape-primary</code>, if the orientation is in the
            primary landscape mode;
          </li>
          <li>
            <code>landscape-secondary</code>, if the orientation is in the
            secondary landscape mode.
          </li>
        </ul>
        <p>
          The notion of primary and secondary depends on the device and the
          platform. Some devices are in portrait mode when the user holds the
          device in the normal orientation, other devices are in landscape mode
          when the user holds the device in its normal orientation. For devices
          whose normal orientation is a landscape mode, that normal orientation
          SHOULD be represented as <code>landscape-primary</code>. For devices
          whose normal orientation is a portrait mode, that normal orientation
          SHOULD be represented as <code>portrait-primary</code>. In both if
          the device is in <code>landscape-primary</code> and is rotated 90
          degrees clockwise, that SHOULD be represented as
          <code>portrait-primary</code>.
        </p>
      </section>
      <section>
        <h2>
          Allowed orientations
        </h2>
        <p>
          The <dfn>allowed orientations</dfn> SHOULD be orientations amongst
          those values:
        </p>
        <ul>
          <li>
            <code>portrait-primary</code>, if the orientation is in the primary
            portrait mode;
          </li>
          <li>
            <code>portrait-secondary</code>, if the orientation is in the
            secondary portrait mode;
          </li>
          <li>
            <code>landscape-primary</code>, if the orientation is in the
            primary landscape mode;
          </li>
          <li>
            <code>landscape-secondary</code>, if the orientation is in the
            secondary landscape mode.
          </li>
          <li>
            <code>portrait</code>, value that represents
            <code>portrait-primary</code> and <code>portrait-secondary</code>
            cases;
          </li>
          <li>
            <code>landscape</code>, value that represents
            <code>landscape-primary</code> and <code>landscape-secondary</code>
            cases;
          </li>
        </ul>
      </section>
      <section>
        <h2>
          Lock the orientation
        </h2>
        <p>
          The action to <dfn>lock the orientation</dfn> consists of forcing the
          rendering of the current <a>browsing context</a> to be shown as if
          the screen was oriented in one or many of the <a>current
          orientation</a>.<br>
          If the lock is done on only one orientation, the screen orientation
          should stay on the given orientation and never change until the
          screen orientation is unlocked. Otherwise, the screen orientation
          should be able to change from an orientation to another as long as
          the orientations are amongst an orientation it has been locked to.
        </p>
      </section>
      <section>
        <h2>
          Supported orientations
        </h2>
        <p>
          A set of orientations is said to be a <dfn>supported
          orientation</dfn> set if the <a>user agent</a> can <a>lock the
          orientation</a> to that set.
        </p>
      </section>
    </section>
    <section>
      <h2>
        Extensions to the <a>Screen</a> Interface
      </h2>The CSSOM View specification defines a <code>Screen</code> interface
      [[!CSSOM-VIEW]], which this specification extends:
      <dl class='idl' title='partial interface Screen : EventTarget'>
        <dt>
          readonly attribute DOMString orientation
        </dt>
        <dt>
          boolean lockOrientation((DOMString or sequence&lt;DOMString&gt;)
          orientations)
        </dt>
        <dt>
          void unlockOrientation()
        </dt>
        <dt>
          [TreatNonCallableAsNull] attribute EventHandler onorientationchange
        </dt>
      </dl>
      <p>
        The <code>orientation</code> attribute MUST return the value
        representing the orientation of the screen. The returned orientation
        MUST be in the <a>current orientation</a> list.
      </p>
      <p>
        The <code>lockOrientation()</code> method, when invoked, MUST run the
        steps for <a>locking the screen orientation</a>. If
        <code>lockOrientation</code> was called with a sequence of strings, the
        sequence should be used as <i>orientation</i> in the mentioned steps.
        Otherwise, the passed string should be the only element in
        <i>orientations</i>. The method MUST return the result returned from
        running previous steps.
      </p>
      <p>
        The <code>unlockOrientation()</code> method, when invoked, MUST disable
        the current lock applied on the screen with
        <code>lockOrientation</code>. If the current <a>browsing context</a>
        has a default orientation, the screen orientation SHOULD revert to
        that. Otherwise, the screen orientation SHOULD revert to any value the
        <a>user agent</a> believes appropriate.
      </p>
      <p>
        When the screen orientation changes in the current <a>browsing
        context</a>, the <a>user agent</a> MUST <a>queue a task</a> which
        updates the <code>orientation</code> attribute and <a>fire a simple
        event</a> named <code>orientationchange</code> at the
        <code>Screen</code> object.
      </p>
      <div class="note">
        <p>
          For example, that means if an application A is locked to
          <code>landscape-primary</code> and application B is locked to
          <code>portrait-primary</code>, switching from application A to B or B
          to A will not fire an <code>orientationchange</code> event because
          both applications will keep the orientation they had.
        </p>
        <p>
          However, locking the orientation can fire an
          <code>orientationchange</code> if the orientation had to be changed
          to satisfy the lock requirements.
        </p>
      </div>
      <section>
        <h2>
          Locking the screen orientation
        </h2>
        <p>
          The steps for <dfn>locking the screen orientation</dfn> are the
          following:
        </p>
        <ol>
          <li>Let <i>orientations</i> be the list of locking orientations.
          </li>
          <li>For each <i>orientation</i> in the <i>orientations</i> list, run
          the following sub steps:
            <ol>
              <li>If <i>orientation</i> isn't part of the <a>allowed
              orientations</a>, the steps MUST stop here and return false.
              </li>
              <li>If <i>orientation</i> is <i>portrait</i> or <i>landscape</i>
              the value should be removed from <i>orientations</i> and every
              <a>allowed orientations</a> it is representing MUST be inserted
              in <i>orientations</i>.
              </li>
            </ol>
          </li>
          <li>If <i>orientations</i> isn't a <a>supported orientation</a> set,
          the steps MUST stop here and return false.
          </li>
          <li>Return true and run the remaining steps asynchronously.
          </li>
          <li>The <a>user agent</a> MUST <a>lock the orientation</a> to
          <i>orientations</i>.
          </li>
          <li>When the lock is done, if the orientation actually changed, the
          <a>user agent</a> MUST <a>fire a simple event</a> named
          <code>orientationnchange</code> at the <code>Screen</code> object.
          </li>
        </ol>
      </section>
    </section>
    <section class='informative'>
      <h2>
        Declarative orientation locking
      </h2>
      <p>
        This specification doesn't intend to specify a declarative orientation
        locking. However, other specifications specify ways to do that.
      </p>
      <p>
        The Web Application Manifest Format and Management APIs
        [[!WEBAPPS-MANIFEST-API]] specifies a way to declare a default
        orientation for a web application inside the manifest file.<br>
        That specification tries to follow this specification regarding
        orientation keywords.
      </p>
      <p>
        The CSS Device Adaptation specification [[!CSS-ADAPTATION]] specifies a
        way to declare a default orientation for a web page.<br>
        That specification isn't yet in sync with this specification.
      </p>
    </section>
    <section>
      <h2>
        Event handlers
      </h2>
      <p>
        The following are the <a>event handlers</a> (and their corresponding
        <a>event handler event types</a>) that MUST be supported as attributes
        by the <code>Screen</code> object:
      </p>
      <table class="simple">
        <thead>
          <tr>
            <th>
              event handler
            </th>
            <th>
              event handler event type
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <strong><code>onorientationchange</code></strong>
            </td>
            <td>
              <code>orientationchange</code>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
    <section class='appendix'>
      <h2>
        Acknowledgments
      </h2>Many thanks to Jonas Sicking and Chris Jones for their contributions
      to the design of this specification.
    </section>
  </body>
</html>
